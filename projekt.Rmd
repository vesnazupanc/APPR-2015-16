---
title: "Analiza smrti v Sloveniji"
author: "Vesna Zupanc"
output:
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
  word_document: default
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Izbira teme

Analizirala bom umrljivost v Sloveniji. Podatke, ki jih bom pridobila bom analizirala po najpogostejših vzrokih za smrt, starosti ter številu smrti po občinah.

Cilj moje analize je predvsem spoznati, kaj je najpogostejši vzrok smrti pri nas, kakšna je najpogostejša starost za smrt, kako se to s časom spremija (če se) ter kje v Sloveniji je najvišja stopnja umrljivosti. 

Podatke sem pridobila iz spletnih strani:

* http://pxweb.stat.si/pxweb/Database/Dem_soc/05_prebivalstvo/32_Umrljivost/05_05L10_umrli_SL/05_05L10_umrli_SL.asp

* https://podatki.nijz.si/pxweb/sl/NIJZ%20podatkovni%20portal/NIJZ%20podatkovni%20portal__3%20Zdravstveno%20stanje%20prebivalstva__3a%20Umrli/?rxid=1bcad944-2947-4c49-8ea7-dfb7131f00e9

* http://www.stat.si/StatWeb/glavnanavigacija/podatki/prikazistaronovico?IdNovice=401


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

Uvozila sem podatke v obliki csv s statističnega urada ter v obliki HTML, kjer sem uvozila dve tabeli iz članka, ki je objavlen na stat.si. 

Pri podatkih, ki sem jih uvozila v obliki HTML, sem namesto ene vrstice, ki se je potem ločila na dve, naredila dve novi vrstici. To sem naredila za povprečno starost umrlih ter pričakovano trajanje življenja, oboje posebej za moške in ženske. 
Pri obeh tabelah sem decimalne vejice zamenjala za pike in poskrbela da so številke spremenljivke res številke.


Poglejmo si tabeli:

```{r tabeleHTML, echo=FALSE}
kable(tabela1)
kable(tabela2)
```

V obliki csv sem uvozila 3 tabele, ki prikazujejo umrle glede na občine v Sloveniji, umrle po starosti in pa po vzroku.

Ker so tabele večje, poglejmo le začetke dveh tabel:

```{r tabelecsv, echo=FALSE}
kable(head(umrli.obcine))
kable(head(umrli.starost))
```

V Grafu sem pokazala število smrti glede na starost:

```{r graf1, echo=FALSE}
ggplot(umrli.starost, aes(x = starost , y = X2014)) + 
      geom_bar(stat='identity') + 
      labs(title ="število umrlih po starosti v letu 2014", x = "starost", y = "") + 
      theme_classic()+ 
      theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

V tortnem diagramu sem pokazala število smrti po posameznem vzroku:

```{r tortni, echo=FALSE}
ggplot(umrlivzrok,aes(x=factor(1),y=X2014,fill=vzrok))+
      geom_bar(width=1,stat="identity")+coord_polar(theta="y") + 
      labs(title ="vzroki smrti", x = "", y = "") + 
      guides(fill=guide_legend(ncol=2, title=NULL)) + 
      theme(legend.position = "bottom", legend.text = element_text(colour="black", size = 5))
```


